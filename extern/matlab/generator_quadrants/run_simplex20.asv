clear
clc
format longg

[p_min40, ks_min40, Ad_min40, Bd_min40, u_min40, phi_min40] = simplex_20rslqr(19.92684089701237, -0.0015087447522203743, ...
    1.710275573600033, -0.7006502737528185, 0.0654197188864468, ...
    0.027296675922235034, 0.269399662083998, -0.31939226219677713, 6, 50, ...
    deg2rad(90) - 0.7006502737528185, 0.7103086497825895, -0.5637563731378527, ...
    0.028419362278802075, -0.1067113431987168);

[p_min20, ks_min20, Ad_min20, Bd_min20, u_min20, phi_min20] = simplex_20rslqr(19.953032053005206, 0.00015393138893321113, ...
    1.3693996959192307, -0.3489905938601243, 0.06429889158732563, ...
    0.011669829101933198, 0.062125310665494794, -0.17070697804314636, 6, 50, ...
    deg2rad(90) - 0.3489905938601243, 0.5204474466464604, -0.5787928371053094, ...
    0.017329124015779063, -0.04389478505937825);

[p_0, ks_0, Ad_0, Bd_0, u_0, phi_0] = simplex_20rslqr(19.959257032508475, 8.529890319855533e-05, ...
    1.2759505956245265, 9.181458768148854e-06, 0.07229047311860616, ...
    0.00018688074160031902, -5.397169272072582e-06, -0.002582645025382552, 6, 50, ...
    deg2rad(90) - 9.181458768148854e-06, 0.7103086497825895, -0.5637563731378527, 0.028419362278802075, -0.1067113431987168);

% [kc_20, kp_20, u_20, phi_20] = simplex_20rslqr(19.95381890836157, 0.0003369887198820557, ...
%     1.3629886994205425, 0.35059347490313253, 0.06416314858042815, ...
%     -0.011303424089387058, 0.06018747129516006, 0.164783963946252);
% 
[p_40, ks_40, Ad_40, Bd_40, u_40, phi_40]  = simplex_20rslqr(19.928577595095373, -0.0005487147160545951, ...
    1.6878515185737344, 0.6981237599378464, 0.0649294904489148, ...
    -0.02622758166310123, 0.2601166796815654, 0.3104817735434434, 6, 50);

fprintf('Simplex\n')
% printAsJsonEntry(u_min40, phi_min40, kc_min40)
% printAsJsonEntry(u_min20, phi_min20, kc_min20)
printAsJsonEntry(u_0, phi_0, p_0, ks_0)
% printAsJsonEntry(u_20, phi_20, kc_20)
% printAsJsonEntry(u_40, phi_40, kc_40, 0)

function printAsJsonEntry(u, phi, p, k, comma)
    if nargin<5 || isempty(comma)
      comma=1;
    end
    fprintf('{\n')
    fprintf('\t\"u\": %e,\n', u)
    fprintf('\t\"phi_rad\": %e,\n', phi)
    numbstr = sprintf('%e, ', p);
    numbstr(end-1:end) = [];
    fprintf('\t\"p\": [%s],\n', numbstr)
    numbstr = sprintf('%e, ', k);
    numbstr(end-1:end) = [];
    fprintf('\t\"k\": [%s]\n', numbstr)
    fprintf('}')

    if comma
        fprintf(',')
    end
        fprintf('\n')

end